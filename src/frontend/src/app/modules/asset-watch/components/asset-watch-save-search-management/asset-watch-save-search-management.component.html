<div class="save-search-management">
  <div class="row">
    <i class="fa-solid fa-angle-left back-link">
      <a (click)="onBackClick()" class="airframe__link airframe__link--inline">Back</a>
    </i>
  </div>
  <div class="row">
    <div>
      <h3 class="col">My Saved Searches ({{ this.saveSearchManagementStore.savedSearchCount$ | async }})</h3>
      <span class="airframe-caption"> Manage your list of saved searches and alerts. </span>
    </div>

    <div class="email-preferences">
      <p class="email-preferences-info">You will receive a single summary email for all your active alerts.</p>
      <ng-template #alertToggleTooltipContent>
        <div class="alert-toggle-tooltip-content">
          <div class="alert-toggle-tooltip-content-title">Email Preferences</div>
          <div>
            As a default setting, you will receive a single summary email as a daily reminder for all your active alerts, even if no
            aircraft are meeting the criteria set.
          </div>
          <div>
            Alternatively, you may choose to receive email alerts only when new alerts have been generated by criteria being met. This
            option means you might not get an email each day.
          </div>
        </div>
      </ng-template>
      <p class="email-preferences-title">
        Email Preferences <em class="fa fa-info-circle" [pTooltip]="alertToggleTooltipContent" tooltipStyleClass="helptip"></em>
      </p>
      <label class="airframe__radiogroup">
        Email daily summary of all active alerts
        <input type="radio" name="emailPreferences" value="Daily" [formControl]="selectedEmailPreferencesControl" />
        <span></span>
      </label>
      <label class="airframe__radiogroup">
        Email only on days alert criteria is met
        <input type="radio" name="emailPreferences" value="AlertsOnly" [formControl]="selectedEmailPreferencesControl" />
        <span></span>
      </label>
    </div>
  </div>

  <div class="row">
    <p-table
      class="saved-search-list"
      styleClass="airframe-table"
      [value]="(this.saveSearchManagementStore.savedSearches$ | async)!"
      [scrollable]="true"
      scrollHeight="800px">
      <ng-template pTemplate="header">
        <tr>
          <th></th>
          <th style="min-width: 270px">Name</th>
          <th style="min-width: 280px">Criteria Set</th>
          <th style="min-width: 180px">Filters Set</th>
          <th style="min-width: 130px">Date Created</th>
          <th style="min-width: 200px">Portfolio</th>
          <th>Email Alert</th>
          <th>Delete</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-savedSearch>
        <tr>
          <td>
            <button type="button" class="airframe__icon-button" (click)="openUpdateSavedSearchDialog(savedSearch)">
              <i class="fa fa-pen-to-square"></i>
            </button>
          </td>
          <td>
            <div>
              <a class="airframe__button airframe__button--flat" [routerLink]="[assetWatchSavedSearchesRoute, savedSearch.id]" (click)="onOpenSavedSearchClick(savedSearch.id)">
                {{ savedSearch.name }}
              </a>
            </div>
            <div>{{ savedSearch.description }}</div>
          </td>
          <td>
            <div *ngIf="savedSearch.minNoOfFlights">
              Min. No. of Flights: {{ savedSearch.minNoOfFlights }} flight<span *ngIf="savedSearch.minNoOfFlights > 1">s</span>
            </div>
            <div *ngIf="savedSearch.minIndividualGroundStay">
              Min. Individual Ground Stay: {{ savedSearch.minIndividualGroundStay }} hour<span
                *ngIf="savedSearch.minIndividualGroundStay > 1"
                >s</span
              >
            </div>
            <div *ngIf="savedSearch.minTotalGroundStay">
              Min. Total Ground Stay: {{ savedSearch.minTotalGroundStay }} hour<span *ngIf="savedSearch.minTotalGroundStay > 1">s</span>
            </div>
            <div *ngIf="savedSearch.minCurrentGroundStay">
              Min. Current Ground Stay: {{ savedSearch.minCurrentGroundStay }} hour<span *ngIf="savedSearch.minCurrentGroundStay > 1"
                >s</span
              >
            </div>
            <div *ngIf="savedSearch.maxCurrentGroundStay">
              Max. Current Ground Stay: {{ savedSearch.maxCurrentGroundStay }} hour<span
                *ngIf="savedSearch.maxCurrentGroundStay > 1"
                >s</span
              >
            </div>
            <div *ngIf="savedSearch.maxIndividualGroundStay">
              Max. Individual Ground Stay: {{ savedSearch.maxIndividualGroundStay }} hour<span
                *ngIf="savedSearch.maxIndividualGroundStay > 1"
                >s</span
              >
            </div>
          </td>
          <td>
            <button type="button" class="airframe__button airframe__button--plain" (click)="viewDetails(savedSearch)">View Details</button>
          </td>
          <td>{{ savedSearch.dateCreated | date : 'longDate' }}</td>
          <td>{{ savedSearch.portfolioName }}</td>
          <td>
            <label class="airframe__toggle"
              ><input type="checkbox" [checked]="savedSearch.isActive" (change)="onIsActiveChange(savedSearch, $event)" /><span></span
            ></label>
          </td>
          <td>
            <button type="button" class="airframe__icon-button" (click)="openDeleteSavedSearchDialog(savedSearch)">
              <i class="fa fa-trash-can delete-saved-search-icon"></i>
            </button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
